# üîê Google OAuth Scopes - –ù–∞—Å—Ç—Ä–æ–π–∫–∞

## ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞: "Error 400: invalid_request"

### –ü—Ä–∏—á–∏–Ω–∞:
Google —Ç—Ä–µ–±—É–µ—Ç **–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö scopes, —Ç–∞–∫–∏—Ö –∫–∞–∫:
- `https://www.googleapis.com/auth/drive.readonly`
- `https://www.googleapis.com/auth/drive`
- –∏ –¥—Ä—É–≥–∏—Ö —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö API

–î–ª—è **–Ω–µ–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ **–±–∞–∑–æ–≤—ã–µ scopes**.

## ‚úÖ –¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–±–∞–∑–æ–≤—ã–µ scopes):

```properties
# application.properties
spring.security.oauth2.client.registration.google.scope=openid,profile,email
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:
- ‚úÖ `openid` - –±–∞–∑–æ–≤–∞—è –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- ‚úÖ `profile` - –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚úÖ `email` - email –∞–¥—Ä–µ—Å

–≠—Ç–∏—Ö scopes **–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ** –¥–ª—è:
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –í—Ö–æ–¥–∞ —á–µ—Ä–µ–∑ Google
- –ü–æ–ª—É—á–µ–Ω–∏—è –±–∞–∑–æ–≤–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ—Ñ–∏–ª–µ

## üîì –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å `drive.readonly`:

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞)

#### –®–∞–≥ 1: –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
Google —Ç—Ä–µ–±—É–µ—Ç:
1. **–î–æ–º–µ–Ω –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è** (–¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –Ω–∞ –≤–∞—Å)
2. **–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏** (Privacy Policy)
3. **–£—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è** (Terms of Service)
4. **–õ–æ–≥–æ—Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**
5. **–°–∫—Ä–∏–Ω—à–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è**

#### –®–∞–≥ 2: –ü–æ–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. **APIs & Services** ‚Üí **OAuth consent screen**
4. –ù–∞–∂–º–∏—Ç–µ **Publish App**
5. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
6. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É

‚è±Ô∏è **–í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏:** 3-7 –¥–Ω–µ–π

#### –®–∞–≥ 3: –ü–æ—Å–ª–µ –æ–¥–æ–±—Ä–µ–Ω–∏—è
–û–±–Ω–æ–≤–∏—Ç–µ `application.properties`:
```properties
spring.security.oauth2.client.registration.google.scope=openid,profile,email,https://www.googleapis.com/auth/drive.readonly
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –¢–µ—Å—Ç–æ–≤—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

–î–ª—è **–Ω–µ–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö** –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–æ **100 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π**:

#### –®–∞–≥ 1: –î–æ–±–∞–≤—å—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
1. [Google Cloud Console](https://console.cloud.google.com/)
2. **APIs & Services** ‚Üí **OAuth consent screen**
3. –ü—Ä–æ–∫—Ä—É—Ç–∏—Ç–µ –¥–æ **Test users**
4. –ù–∞–∂–º–∏—Ç–µ **Add Users**
5. –î–æ–±–∞–≤—å—Ç–µ email –∞–¥—Ä–µ—Å–∞ (–¥–æ 100)

#### –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç–µ scopes
```properties
spring.security.oauth2.client.registration.google.scope=openid,profile,email,https://www.googleapis.com/auth/drive.readonly
```

‚ö†Ô∏è **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω—ã—Ö email –∞–¥—Ä–µ—Å–æ–≤
- –ú–∞–∫—Å–∏–º—É–º 100 —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ "Unverified app"

### –í–∞—Ä–∏–∞–Ω—Ç 3: Internal App (–¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π Google Workspace)

–ï—Å–ª–∏ —É –≤–∞—Å Google Workspace Organization:

1. **User Type** ‚Üí **Internal**
2. Scopes –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. –†–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤–∞—à–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

## üîÑ –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (—Ç–µ–∫—É—â–µ–µ):

–ò—Å–ø–æ–ª—å–∑—É–µ–º **—Ç–æ–ª—å–∫–æ –±–∞–∑–æ–≤—ã–µ scopes**:

```properties
# –ë–µ–∑ drive.readonly - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
spring.security.oauth2.client.registration.google.scope=openid,profile,email
```

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- ‚úÖ –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ email –∏ –∏–º–µ–Ω–∏
- ‚ùå –î–æ—Å—Ç—É–ø –∫ Google Drive (—Ç—Ä–µ–±—É–µ—Ç –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏)

## üìã Checklist –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:

- [ ] –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –¥–æ–º–µ–Ω (evalyze.by –∏–ª–∏ –¥—Ä—É–≥–æ–π)
- [ ] –°–æ–∑–¥–∞—Ç—å Privacy Policy (–ø–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏)
- [ ] –°–æ–∑–¥–∞—Ç—å Terms of Service (—É—Å–ª–æ–≤–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)
- [ ] –ó–∞–≥—Ä—É–∑–∏—Ç—å –ª–æ–≥–æ—Ç–∏–ø –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- [ ] –°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- [ ] –ó–∞–ø–æ–ª–Ω–∏—Ç—å —Ñ–æ—Ä–º—É OAuth consent screen
- [ ] –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é
- [ ] –î–æ–∂–¥–∞—Ç—å—Å—è –æ–¥–æ–±—Ä–µ–Ω–∏—è (3-7 –¥–Ω–µ–π)
- [ ] –û–±–Ω–æ–≤–∏—Ç—å scopes –≤ `application.properties`

## üîß –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ API:

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–∞–º, –Ω–æ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –µ—â–µ –Ω–µ –ø—Ä–æ—à–ª–∞:

### –í–∞—Ä–∏–∞–Ω—Ç 1: Google Drive API (—Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏)
–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ scope `drive.file` –≤–º–µ—Å—Ç–æ `drive.readonly`:
- –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Ñ–∞–π–ª–∞–º, —Å–æ–∑–¥–∞–Ω–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –ø–æ–ª–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç 2: Google Picker API
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ UI
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- –ë–æ–ª–µ–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ, –º–µ–Ω—å—à–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤ –≤—Ä—É—á–Ω—É—é
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–∞–π–ª—ã —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É
- –ù–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ Google Drive
- –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –≤–∞—Ä–∏–∞–Ω—Ç

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è):

### –ï—Å–ª–∏ –Ω—É–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å drive.readonly –°–ï–ô–ß–ê–°:

1. –î–æ–±–∞–≤—å—Ç–µ —Å–µ–±—è –∫–∞–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Google Cloud Console
2. –û–±–Ω–æ–≤–∏—Ç–µ `application.properties`:
   ```properties
   spring.security.oauth2.client.registration.google.scope=openid,profile,email,https://www.googleapis.com/auth/drive.readonly
   ```
3. –ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –∏ –∑–∞–¥–µ–ø–ª–æ–π—Ç–µ
4. –í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Google —Å email, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–±–∞–≤–∏–ª–∏ –∫–∞–∫ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üìù –ò—Ç–æ–≥:

**–¢–µ–∫—É—â–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–ø—Ä–æ–¥–∞–∫—à–µ–Ω-ready):**
```properties
# –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –í–°–ï–• –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
spring.security.oauth2.client.registration.google.scope=openid,profile,email
```

**–ü–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–∫–æ–≥–¥–∞ –ø–æ–ª—É—á–∏–º –æ–¥–æ–±—Ä–µ–Ω–∏–µ Google):**
```properties
# –†–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –í–°–ï–• + –¥–æ—Å—Ç—É–ø –∫ Google Drive
spring.security.oauth2.client.registration.google.scope=openid,profile,email,https://www.googleapis.com/auth/drive.readonly
```

**–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
```properties
# –†–∞–±–æ—Ç–∞–µ—Ç –¢–û–õ–¨–ö–û –¥–ª—è email, –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –≤ Test Users
spring.security.oauth2.client.registration.google.scope=openid,profile,email,https://www.googleapis.com/auth/drive.readonly
```

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:

–ü–æ–∫–∞ –∏–¥–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **–±–∞–∑–æ–≤—ã–µ scopes** (`openid,profile,email`). 
–≠—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é —Ä–∞–±–æ—Ç–∞—Ç—å –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è –æ–¥–æ–±—Ä–µ–Ω–∏—è –æ—Ç Google, –ø—Ä–æ—Å—Ç–æ –æ–±–Ω–æ–≤–∏—Ç–µ scopes –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.


